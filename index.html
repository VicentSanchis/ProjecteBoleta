
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.5.3, mkdocs-material-9.1.15" name="generator"/>
<title>Projecte Bola de Drac</title>
<link href="assets/stylesheets/main.26e3688c.min.css" rel="stylesheet"/>
<link href="assets/stylesheets/palette.ecc896b0.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="stylesheet/extra.css" rel="stylesheet"/>
<link href="https://cdnjs.cloudflare.com/ajax/libs/mermaid/7.0.9/mermaid.neutral.css" rel="stylesheet"/>
<script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr">
<script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#projecte-bola-de-drac">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Projecte Bola de Drac" class="md-header__button md-logo" data-md-component="logo" href="." title="Projecte Bola de Drac">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Projecte Bola de Drac
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Index
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18V6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-2.69L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69Z"></path></svg>
</label>
<input aria-label="Switch to system preference" class="md-option" data-md-color-accent="white" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="black" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to system preference">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18V6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-2.69L23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69Z"></path></svg>
</label>
</form>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--integrated" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Projecte Bola de Drac" class="md-nav__button md-logo" data-md-component="logo" href="." title="Projecte Bola de Drac">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
    Projecte Bola de Drac
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Index
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href=".">
        Index
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#el-llenguatge-java">
    El llenguatge Java
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#programacio-modular">
    Programació Modular
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#tipus-compostos-de-dades">
    Tipus Compostos de Dades
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#programacio-orientada-a-objectes">
    Programació orientada a objectes
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#classe-animator-reutilitzacio-de-classes">
    Classe Animator - Reutilització de classes
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#herencia-i-polimorfisme">
    Herència i polimorfisme
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#afegim-pantalles-al-projecte">
    Afegim Pantalles al Projecte
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#guardem-el-progres-del-joc">
    Guardem el progrés del joc
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="projecte-bola-de-drac">Projecte Bola de Drac</h1>
<p>El projecte de la <strong>bola de drac</strong> és un xicotet joc que desenvoluparem a classe amb <strong>Java i Processing IDE</strong>. En aquest projecte començarem simulant un <strong>sistema de físiques</strong> molt simple en el que una bola caurà poc a poc gràcies a la força de la gravetat. </p>
<p><center>
<img alt="Boleta amb Cursors" src="assets/bolaDrac.gif" style="height:300px;border:1px solid silver;"/>
</center></p>
<p>Poc a poc i al mateix temps que anem assolint els coneixements necessaris ampliarem les funcionalitats de la bola, per exemple que puga <strong>rebotar</strong> quan toque les vores de l'aplicació, que puguem utilitzar els cursors al joc per impulsar o <strong>moure la bola.</strong></p>
<p>Finalment podriem afegir també <strong>obstacles, enemics i animacions...</strong></p>
<h2 id="el-llenguatge-java">El llenguatge Java</h2>
<p>En aquest tema 3 hem vist bàsicament la sintaxi de Java. És per tant el tema més dens que hem vist de moment i amb molts conceptes que assolir. A continuació i basant-nos en aquest xicotet projecte, revisarem un a un aquests conceptes construint pas a pas el projecte.  Si no recordes algun concepte vist a classe, et recomane que revises els apartats mentre anem mirant-los. Comencem per les dades, variables i identificadors.</p>
<h3 id="dades-variables-identificadors">Dades Variables identificadors</h3>
<p>El <strong>primer</strong> que has de fer és molt senzill, obre l'entorn de desenvolupament integrat de <strong>Processing IDE</strong>, copia el codi que tens a continuació i apega'l a l'editor. Aquest codi serà la <strong>base</strong> per al projecte de la boleta que desenvoluparem pas a pas. Finalment guarda'l amb el nom <strong>ProjecteBola.pde</strong> per exemple.</p>
<details class="info">
<summary>Codi base sobre el que construirem el projecte</summary>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Projecte Bola de Drac</span>
<span class="cm">     * ------------------------------------------------------------------------------------------------------</span>
<span class="cm">     * Xicotet projecte de simulació d'un sistema de físiques que finalment acabarà convertint-se en un joc </span>
<span class="cm">     * simple amb enemics, obstacles i puntuació</span>
<span class="cm">     * @author Vicent Sanchis</span>
<span class="cm">     * @since  10/10/2023</span>
<span class="cm">     * @version 1.0</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="c1">// ------------------------------------------------------------------------------------------------------</span>
<span class="w">    </span><span class="c1">// Constants</span>
<span class="w">    </span><span class="c1">// ------------------------------------------------------------------------------------------------------ </span>
<span class="w">    </span><span class="c1">// Variables Globals</span>
<span class="w">    </span><span class="c1">// ------------------------------------------------------------------------------------------------------</span>
<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Mètode setup</span>
<span class="cm">     * Mètode de configuració de l'aplicació,  només s'executa una volta</span>
<span class="cm">     * Ací solen anar les inicialitzacions i setup inicial</span>
<span class="cm">     * @return void</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setup</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">size</span><span class="w"> </span><span class="p">(</span><span class="mi">640</span><span class="p">,</span><span class="w"> </span><span class="mi">480</span><span class="p">);</span><span class="w">   </span><span class="c1">// Defineix la grandària de la pantalla de la nostra aplicació</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="cm">/**</span>
<span class="cm">     * Mètode draw</span>
<span class="cm">     * Mètode que s'executa tantes vegades per segon com fps estiga configurat</span>
<span class="cm">     * També conegut com el bucle de joc. Ací va el principal del programa</span>
<span class="cm">     * @return void</span>
<span class="cm">     */</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">draw</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
</details>
<p>Si executes el codi que has copiat amb el <strong>Processing IDE</strong> veuras que només ix una pantalla de 640 pixels per 480 pixels i res més. No et preocupes, és normal. Ara anirem poc a poc afegint el codi necessari per anar construint el nostre joc.</p>
<details class="question">
<summary>Activitat 1. Identificadors del nostre projecte</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio"><input id="__tabbed_1_2" name="__tabbed_1" type="radio"><div class="tabbed-labels"><label for="__tabbed_1_1">Problema</label><label for="__tabbed_1_2">Solució</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>En aquest joc anem a necessitar una sèrie de variables on emmagatzemarem informació sobre:</p>
<div class="highlight"><pre><span></span><code>1. Posició de la boleta (coordenada X):
2. Posició de la boleta (coordenada Y):
3. Velocitat de la boleta (coordenada X):
4. Velocitat de la boleta (coordenada Y):
5. Color RGB de la boleta:
</code></pre></div>
<p>Per a cadascuna de futures variables anteriors tria un identificador seguint les normes de creació d'identificadors vistes a classe i que siga significatiu.</p>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>1. Posició de la boleta (coordenada X): posX
2. Posició de la boleta (coordenada Y): posY
3. Velocitat de la boleta (coordenada X): velX
4. Velocitat de la boleta (coordenada Y): velY
5. Color RGB de la boleta: colorRGB (utilitzarem un tipus especial que es diu **color**)
</code></pre></div>
</div>
</div>
</input></input></div>
</details>
<p>Una vegada ja tenim els identificadors escollits ens quedaria posar-los al nostre projecte. És a dir, has de declarar les variables associades als identificadors de l'activitat anterior al nostre projecte. Recorda que declarar una variable bàsicament consisteix en associar-li a l'identificador el <strong>tipus de dades</strong> adequat.</p>
<details class="question">
<summary>Activitat 2. Declaració de variables al projecte</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio"><input id="__tabbed_2_2" name="__tabbed_2" type="radio"><div class="tabbed-labels"><label for="__tabbed_2_1">Problema</label><label for="__tabbed_2_2">Solució</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Llig el que hages respost a l'activitat anterior i declara com consideres dins del bloc de <strong>"Variables Globals"</strong> els identificadors que hages triat com a variables amb el <strong>tipus base</strong> que trobes que es necessite. Mira l'exemple de la variable velocitat si no saps per on començar.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Declara les variables globals a la seua secció.</span>
<span class="kt">int</span><span class="w"> </span><span class="n">velX</span><span class="p">;</span><span class="w">  </span><span class="c1">// Exemple de declaració d'una variable 'velocitat'</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">setup</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">size</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span><span class="mi">480</span><span class="p">);</span>
<span class="p">}</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">draw</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">background</span><span class="p">(</span><span class="mi">255</span><span class="p">);</span><span class="w">  </span><span class="c1">// Pinta el fons de blanc</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Recorda que aquesta activitat l'has de fer amb <strong>Processing IDE</strong>. Guarda el fitxer resultant amb el nom següent: <strong>ProjecteBola.pde</strong></p>
</div>
<div class="tabbed-block">
<p><a href="assets/Activitat2.pde">Descarrega la solució de l'activitat 2</a></p>
</div>
</div>
</input></input></div>
</details>
<h3 id="operadors-i-expressions">Operadors i expressions</h3>
<p>Ja tens les variables necessàries per poder començar amb el projecte declarades al teu fitxer <strong>ProjecteBola.pde</strong> ara per poder seguir amb el joc, has de donar-los algun valor inicial a les <strong>variables declarades</strong> a l'activitat anterior. Recorda que per donar valor a una variable s'han d'utilitzar dues coses que has vist al tema 3: l'operador assignació <strong>=</strong> i un <strong>literal</strong> del mateix tipus que siga la variable a la qual vols donar valor.</p>
<p>Les <strong>assignacions de valors inicials</strong> a les variables del nostre projecte es faran dins del <strong>setup</strong>. Teniu en compte que és en aquest mètode en el que es solen configurar les aplicacions, per tant, és un bon lloc per poder donar-los a les variables el seu valor inicial amb el que començaran quan s'execute l'app.</p>
<details class="question">
<summary>Activitat 3. Inicialització de variables del projecte</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio"><input id="__tabbed_3_2" name="__tabbed_3" type="radio"><div class="tabbed-labels"><label for="__tabbed_3_1">Problema</label><label for="__tabbed_3_2">Solució</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Com que hem declarat totes les variables a la secció de <strong>'Variables Globals'</strong> per tal que se li puga assignar valor des de qualsevol lloc. Ara hauràs de assignar-li un valor literal a cada identificador declarat com hem vist. Fixa't en l'exemple de posX.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Variables Globals</span>
<span class="kt">int</span><span class="w"> </span><span class="n">posX</span><span class="p">,</span><span class="w"> </span><span class="n">posY</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">setup</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">size</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span><span class="mi">480</span><span class="p">);</span>
<span class="w">    </span><span class="n">posX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">320</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">draw</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">background</span><span class="p">(</span><span class="mi">255</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Guarda aquesta activitat amb el nom de: <strong>ProjecteBola.pde</strong></p>
</div>
<div class="tabbed-block">
<p><a href="assets/Activitat3.pde">Descarrega la solució de l'activitat 3</a></p>
</div>
</div>
</input></input></div>
</details>
<h3 id="constants">Constants</h3>
<p>Com has vist al <a href="https://vicentsanchis.github.io/Programacio/Tema%2003.%20El%20llenguatge%20Java/">Tema 3</a> les <strong>constants</strong> són identificadors que representen valors immutables durant l'execució del programa. Trobes que podriem usar alguna constant al nostre projecte?. Mira l'activitat següent:</p>
<details class="question">
<summary>Activitat 4. Ús de constants al nostre projecte</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio"/><input id="__tabbed_4_2" name="__tabbed_4" type="radio"/><div class="tabbed-labels"><label for="__tabbed_4_1">Problema</label><label for="__tabbed_4_2">Solució</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>La finalitat del joc de la boleta, a banda de aprendre java, és simular les lleis de la gravetat amb una boleta. Dins de les lleis de la gravetat existeix una constant que és la força de la gravetat (9,8m/s²).</p>
<p>Declara una constant amb nom 'GRV', o algun altre identificador significatiu i assigna-li el valor de la gravetat. Prova diversos valors de la gravetat fins que trobes aquell que siga més adequat.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Declara la constant a la secció de constants</span>

<span class="c1">// Variables globals    </span>
<span class="kt">int</span><span class="w"> </span><span class="n">posX</span><span class="p">,</span><span class="w"> </span><span class="n">posY</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">setup</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">size</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span><span class="mi">480</span><span class="p">);</span>
<span class="w">    </span><span class="n">posX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">320</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">draw</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">background</span><span class="p">(</span><span class="mi">255</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Què passa si al mètode draw intentes canviar-li el valor a alguna constant en temps d'execució? Prova-ho.</p>
</div>
<div class="tabbed-block">
<p><a href="assets/Activitat4.pde">Descarrega la solució de l'activitat 4</a></p>
</div>
</div>
</div>
</details>
<h3 id="estructures">Estructures</h3>
<p>Abans de continuar amb l'exemple de la boleta anem a refrescar un poc la memòria sobre les <strong>fases de desenvolupament de programari</strong> que varem veure al primer tema i la tècnica de disseny de diagrames de flux i la aplicarem al nostre projecte.</p>
<h4 id="1-fase-danalisi-o-que-volem-fer">1. Fase d'analisi o què volem fer</h4>
<p>Es pretén fer una aplicació amb una pantalla de grandària 640 píxels d'ample  i 480 píxels d'alt amb fons blanc i una boleta de 20 píxels de diametre al mig de la pantalla en la seua posició inicial. Una vegada arranque l'aplicació la boleta anirà caent aplicant la llei de la gravetat tenint en compte que la seua velocitat inicial és zero. Quan arribe al terra, la bola desapareixerà i s'acabarà el programa.</p>
<div class="highlight"><pre><span></span><code>- Requeriment 1: La pantalla de l'aplicació és de 640 píxels d'ample per 480 píxels d'alt.
- Requeriment 2: La posició inicial de la boleta és al mig de la pantalla dalt (320,50)
- Requeriment 3: La velocitat inicial de la boleta és zero.
- Requeriment 4: L'acceleració de la boleta és de 9,8 m/s².
- Requeriment 5: Quan la boleta toque terra anirà desapareixent i acabarà l'execució del programa.
</code></pre></div>
<h4 id="2-fase-de-disseny">2. Fase de disseny</h4>
<p>Basant-nos en l'especificació de la fase d'analisi anterior i els requeriments que hem aconseguit treure, dissenyem el nostre algorisme utilitzant, per exemple, la tècnica dels <strong>diagrames de flux</strong>. Un possible resultat podria ser el següent:</p>
<div class="mermaid">    graph LR
        Ini((Inici))--&gt;A[GRV=0.098];
        A--&gt;B[Establir Dimensions<br/>Ample=640<br/>Alt=480];
        style Ini fill:#0F0;
        B--&gt;C[Establir Posició Inicial<br/>posX=320<br/>posY=50];
        C--&gt;D[Actualitzar Posició Bola];
        D--&gt;E[Dibuixar Bola];
        E--draw: Bucle Joc--&gt;D;
</div>
<h4 id="3-fase-dimplementacio">3. Fase d'implementació</h4>
<p>Ara hem de passar el disseny a codi en Java. Coses a tenir en compte: </p>
<div class="highlight"><pre><span></span><code>- Les dimensions de la boleta seran constants o variables?
- Els identificadors de la posició de la boleta són variables o constants?.
- La acceleració és una variable o una constant?
- Com puc dibuixar una boleta amb Processing IDE?
- Com s'actualitza la posició de la boleta?
- L'unitat de temps no és el segon si no el frame. Com sé en quin frame estic a l'actualitat?
- L'unitat de mesura no són els metres si no el píxel.
</code></pre></div>
<p>En realitat, l'única qüestió per a la que possiblement no tingues resposta és la cinquena i és en aquesta part on realment aplicarem <strong>operacions aritmètiques</strong> per tal d'actualitzar la posició de la boleta. Per saber la posició de la boleta a cada frame utilitzarem les formules del <strong>MRUA</strong> per calcular la velocitat en tot moment i així poder actualitzar la posició. </p>
<p>Una <strong>última consideració</strong> és que com que estem fent un simulador simple, no cal ser precisos amb les unitats de mesura i els seus valors, per exemple: la gravetat és 9,88 metres per segon cada segon però per al nostre simulador anem a establir que la gravetat (acceleració) és de 1 pixel per frame cada frame.</p>
<details class="info">
<summary>Moviment Rectilini Uniformement Accelerat</summary>
<p>Per tal de fer els càlculs més simple i comprensibles, considerem que GRV val 1.
Amb les formules del <strong>MRUA</strong> podem saber en tot moment on es troba la boleta. Si a l'inici la boleta es troba en la posició y=120 i la velocitat inicial a l'eix Y velY=0, passat una unitat de temps (1 frame) la distància recorreguda per part de la boleta seria:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Frame 0</span>
<span class="n">velY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">velY</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">a</span><span class="o">*</span><span class="n">t</span>
<span class="n">velY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">velY</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">GRV</span><span class="o">*</span><span class="p">(</span><span class="n">frameCount</span><span class="o">/</span><span class="n">frameRate</span><span class="p">);</span>
<span class="n">velY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="o">*</span><span class="mi">0</span><span class="p">;</span>
<span class="n">velY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">posY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">posY</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">velY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</code></pre></div>
<p>És a dir, a l'instant zero la boleta es troba en la seua posició inicial i té una velocitat de 0 (pixels/frame). Lògic no?</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Frame 1</span>
<span class="n">velY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">velY</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">GRV</span><span class="o">*</span><span class="p">(</span><span class="n">frameCount</span><span class="o">/</span><span class="n">frameRate</span><span class="p">);</span>
<span class="n">velY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">60</span><span class="p">)</span>
<span class="n">velY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">60</span><span class="p">;</span>
<span class="n">posY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">posY</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">velY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">60</span><span class="p">;</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">// Frame 2</span>
<span class="n">velY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">velY</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">GRV</span><span class="o">*</span><span class="p">(</span><span class="n">frameCount</span><span class="o">/</span><span class="n">frameRate</span><span class="p">);</span>
<span class="n">velY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">60</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="mi">60</span><span class="p">);</span>
<span class="n">velY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">60</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">/</span><span class="mi">60</span><span class="p">;</span>
<span class="n">posY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">posY</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">velY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">/</span><span class="mi">60</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">2</span><span class="o">/</span><span class="mi">60</span><span class="p">;</span>
<span class="n">posY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">/</span><span class="mi">60</span><span class="p">;</span>
</code></pre></div>
<p>És a dir, passada una unitat de temps (1 frame) la boleta haurà recorregut 3/60 pixels. Continuem:</p>
<div class="highlight"><pre><span></span><code><span class="c1">// Frame 3</span>
<span class="n">velY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">velY</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">GRV</span><span class="o">*</span><span class="p">(</span><span class="n">frameCount</span><span class="o">/</span><span class="n">frameRate</span><span class="p">);</span>
<span class="n">velY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">/</span><span class="mi">60</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">/</span><span class="mi">60</span><span class="p">);</span>
<span class="n">velY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">/</span><span class="mi">60</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="o">/</span><span class="mi">60</span><span class="p">;</span>
<span class="n">posY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">posY</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">velY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="o">/</span><span class="mi">60</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="o">/</span><span class="mi">60</span><span class="p">;</span>
<span class="n">posY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">6</span><span class="o">/</span><span class="mi">60</span>
</code></pre></div>
<p>I axí successivament fins que la boleta acabaria desapareixent per la part de baix de la nostra aplicació.</p>
<p>En conclusió, eixa instrucció del diagrama de flux anterior que hi posa <strong>Actualitzar Posició Bola</strong> en realitat seria: velY=velY+GRV*(frameCount/frameRate) i posY = posY + velY.</p>
</details>
<p>Si has llegit i entès l'explicació anterior sobre el <strong>Moviment rectilini uniformement accelerat</strong>, fes l'activitat 5 on per primera vegada es veurà la boleta en moviment.</p>
<details class="question">
<summary>Activitat 5. Fer caure la boleta</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio"/><input id="__tabbed_5_2" name="__tabbed_5" type="radio"/><div class="tabbed-labels"><label for="__tabbed_5_1">Problema</label><label for="__tabbed_5_2">Solució</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Escriu un programa en Java amb <strong>Processing IDE</strong> en base a les especificacions anteriors i que resolga el problema de la boleta. És a dir, que a l'inici el programa dibuixe una boleta a la posició <strong>x=320</strong> i <strong>y=50</strong> i que com a conseqüència de la força de la gravetat vaja caent fins desapareixer de la pantalla de la nostra aplicació.</p>
<p>Les <strong>variables</strong> que determinen la posició i la velocitat de la boleta han de tenir <strong>precisió flotant</strong> (float) ja que com has pogut observar a l'apartat del moviment rectilini uniformement accelerat, les distintes operacions que s'han de fer utilitzen decimals.</p>
<p><center>
<img alt="Boleta" src="assets/Boleta.gif"/>
</center></p>
<p><strong>CONSIDERACIÓ:</strong> Penses que la grandària de la boleta podria ser una constant?</p>
</div>
<div class="tabbed-block">
<p>Encara no disponible
<a href="assets/Activitat5.pde">Descarrega la solució de l'activitat 5</a></p>
</div>
</div>
</div>
</details>
<p>Abans de passar a la següent secció, millorem el que ja tenim fet. El que es preten amb aquesta activitat és que el punt d'inici de la boleta no siga sempre el mateix i varie cada vegada que s'arranque el joc. 
Llig i fes la següent activitat:</p>
<details class="question">
<summary>Activitat 6. Que la boleta  no aparega sempre al mateix lloc</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio"/><input id="__tabbed_6_2" name="__tabbed_6" type="radio"/><div class="tabbed-labels"><label for="__tabbed_6_1">Problema</label><label for="__tabbed_6_2">Solució</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>En aquesta activitat anem a fer que la boleta no aparega sempre a la posició x=320, y=50 si no que cada vegada que arranquem l'aplicació, aparega en un lloc diferent. </p>
<p>Per tal d'aconseguir aquesta aleatorietat, utilitzarem la funció de Processing IDE <strong>random</strong>. </p>
<p>A l'API de Processing, <a href="https://processing.org/reference/">Processing Reference</a>, entre altres tenim una funció <strong>random(low, high)</strong> que genera nombres aleatoris dintre del rang low-hight que se li passa per paràmetre, és a dir, si volem que aquesta funció ens torne un valor aleatori entre 0 i 100, hauríem de cridar-la de la següent forma:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kt">float</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">random</span><span class="p">(</span><span class="mi">100</span><span class="p">);</span><span class="w">   </span><span class="c1">// Genera un nombre aleatori entre 0 i 100 i l'emmagatzema a f</span>
<span class="kt">float</span><span class="w"> </span><span class="n">m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">random</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">90</span><span class="p">);</span><span class="w"> </span><span class="c1">// Genera un nombre aleatori entre 50 i 90 i l'emmagatzema a m</span>
</code></pre></div></td></tr></table></div>
<p>Primer fes que tant les variables que determinen la posició x i y de la boleta les genere la funció random i no siguen fixes.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Per exemple</span>
<span class="n">posX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">random</span><span class="p">(</span><span class="mi">640</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>També fes que la gravetat també tinga major precisió i assigna-li un valor de 0.0098.</p>
<p>Si executes prou vegades l'activitat 6 t'adonaràs que de vegades la boleta apareix en els extrems de la pantalla i de vegades tant baixeta que no s'arriba a apreciar el seu comportament. Investiga la funció <strong>random</strong> de Processing API i fes que la boleta aparega sempre entre els següents rangs:</p>
<ul>
<li>posX entre 100 i 540</li>
<li>posY entre 50 i 150</li>
</ul>
</div>
<div class="tabbed-block">
<p>Encara no disponible
<a href="assets/Activitat6.pde">Descarrega la solució de l'activitat 6</a></p>
</div>
</div>
</div>
</details>
<h4 id="estructura-de-seleccio-simple">Estructura de selecció simple</h4>
<p>Fent ús de les estructures de selecció vistes al tema 3, farem que el nostre joc siga més eficient i precís. Si has fet les activitats anteriors hauràs pogut observar que la boleta desapareix per la part de baix de la nostra aplicació i no la tornem a veure. Anem a corregir este comportament utilitzant una estructura de selecció <strong>if</strong></p>
<p>Continuem amb la boleta i ampliem funcionalitats i millorem el diagrama de flux de la fase de disseny</p>
<div class="mermaid">graph LR
    Ini((Inici))--&gt;A[GRV=0.098f];
    A--&gt;B[Establir Dimensions<br/>Ample=640<br/>Alt=480];
    style Ini fill:#0F0;  
    B--&gt;C[Establir Posició Inicial<br/>posX=random xMin-xMax<br/>posY=random yMin-yMax];
    C--&gt;E[Actualitzar Posició Bola<br/>velY=velY+GRV*frameCount/frameRate<br/>posY=posY+velY];
    E--&gt;F{Ha desaparegut?};
    F--&gt;|SI|G[posX=0];
    G--&gt;H[velY = 0];
    H--&gt;D;
    F--&gt;|NO|D;        
    D[Dibuixar Bola];
    D--Draw: Bucle Joc--&gt;E;
</div>
<p>El primer que farem en aquesta secció és que la boleta no desaparega. Fins ara la nostra boleta apareix en un lloc <strong>random</strong> de la finestra de l'aplicació i comença a caure fins que desapareix. Hem d'evitar això com mostra el diagrama de flux.</p>
<details class="question">
<summary>Activitat 7. Que no desaparega la boleta</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio"/><input id="__tabbed_7_2" name="__tabbed_7" type="radio"/><div class="tabbed-labels"><label for="__tabbed_7_1">Problema</label><label for="__tabbed_7_2">Solució</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Hem d'aconseguir que la boleta torne a apareixer per dalt quan arribe desaparega per la part de baix de l'aplicació. Què significa que la boleta ha desaparegut per baix? o dit d'una altra manera, com sabem que la boleta ha desaparegut per complet? Per què la el valor de la variable que indica la posició a l'eix Y <strong>posY</strong> de la boleta és major que l'alt de la nostra aplicació més la meitat de la grandària de la boleta, és a dir: 495. Per tant podem deduir que: "Si la posició Y de la boleta és major que 495 aleshores la fem apareixer per dalt..."</p>
<p>Com podeu observar, l'afirmació anterior és un <strong>if</strong>, si posY és major (&gt;) altura aleshores fes apareixer per dalt de nou la boleta. Però quines són les accions a realitzar per tal que la boleta aparega per dalt? tornar a posar la posició Y de la boleta a 0 menys la meitat de la seua grandària (TAM).</p>
<p>També s'ha de reiniciar la velocitat a zero sino no pararà d'accelerar.</p>
<p><strong>Comprovació:</strong> Què passa si canvies el valor de TAM a 50? Funciona com hauria de funcionar?</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="c1">// Constants</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">float</span><span class="w"> </span><span class="n">GRV</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.098f</span><span class="p">;</span><span class="w"> </span><span class="c1">// Força de la gravetat</span>
<span class="w">    </span><span class="kd">final</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">int</span><span class="w">   </span><span class="n">TAM</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">30</span><span class="p">;</span><span class="w">     </span><span class="c1">// Grandària de la boleta</span>

<span class="w">    </span><span class="c1">// Variables Globals</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">velX</span><span class="p">,</span><span class="w"> </span><span class="n">velY</span><span class="p">;</span><span class="w">             </span><span class="c1">// Velocitat inicial de l'objecte quan arranquem el programa.</span>
<span class="w">    </span><span class="kt">float</span><span class="w"> </span><span class="n">posX</span><span class="p">,</span><span class="w"> </span><span class="n">posY</span><span class="p">;</span><span class="w">             </span><span class="c1">// Variables que determinen la posició de la boleta en un escenari de dues dimensions</span>

<span class="w">    </span><span class="c1">// Mètode setup: inicialitza la nostra aplicació, dona valors inicials.</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">setup</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">size</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span><span class="mi">480</span><span class="p">);</span><span class="w">               </span><span class="c1">// Establir dimensions</span>
<span class="w">        </span><span class="n">posX</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">random</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">600</span><span class="p">);</span><span class="w">  </span><span class="c1">// Establim posició X inicial</span>
<span class="w">        </span><span class="n">posY</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="n">random</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">440</span><span class="p">);</span><span class="w">  </span><span class="c1">// Establim posició Y inicial</span>
<span class="w">        </span><span class="n">velX</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">               </span><span class="c1">// Establim la velocitat X inicial</span>
<span class="w">        </span><span class="n">velY</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">               </span><span class="c1">// Establim la velocitat Y inicial</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// Metode draw: bucle del joc, aquest mètode s'executa de forma continua</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">draw</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">clear</span><span class="p">();</span>
<span class="w">        </span><span class="n">background</span><span class="p">(</span><span class="mi">255</span><span class="p">);</span>

<span class="w">        </span><span class="c1">// Actualitzem la posició utilitzant la velocitat </span>
<span class="w">        </span><span class="n">velY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">velY</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">GRV</span><span class="o">*</span><span class="p">(</span><span class="n">frameCount</span><span class="o">/</span><span class="n">frameRate</span><span class="p">);</span><span class="w">  </span><span class="c1">// Vf = Vo + acc*temps;</span>
<span class="w">        </span><span class="n">posY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">posY</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">velY</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// Codi if que controle si ha arribat al terra o no.</span>
<span class="w">        </span><span class="c1">// if...</span>

<span class="w">        </span><span class="c1">// Dibuixem la boleta</span>
<span class="w">        </span><span class="n">fill</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
<span class="w">        </span><span class="n">circle</span><span class="p">(</span><span class="n">posX</span><span class="p">,</span><span class="n">posY</span><span class="p">,</span><span class="n">TAM</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p><center>
<img alt="Boleta" src="assets/Act319.gif"/>
</center></p>
</div>
<div class="tabbed-block">
<p><a href="assets/Activitat7.pde">Descarrega la solució de l'activitat 7</a></p>
</div>
</div>
</div>
</details>
<h4 id="el-depurador-de-processing-ide">El depurador de Processing IDE</h4>
<p>Ha arribat el moment que aprengues com funciona el depurador que és una eina molt important per a desenvolupar codi. El depurador o <strong>debugger</strong> és una eina molt important i necessària que porten tots els entorns de desenvolupament integrat com Processing. Aquesta eina ens permet executar el codi pas a pas al mateix temps que podem monitoritzar el valor de les variables, l'estat dels diferent objectes que formen part de la nostra aplicació. </p>
<p><center>
<img alt="Debugger" src="assets/Debugger.png"/>
</center></p>
<p>Per poder activar el depurador hem de fer clic al botó redó que es troba dalt a la dreta de l'editor com es mostra a la imatge anterior. Una vegada tenim el depurador activat, se'ns obre el <strong>monitor de variables</strong> que ens permetrà controlar com canvien les variables de valor. </p>
<p>A la part esquerra ens apareixeran els controls que ens habilitaran per poder navegar pas a pas o entrar en funcions i mètodes del codi.</p>
<p>Finalment és molt important també per a la depuració de codi el terme <strong>breakpoint</strong> per fer que el depurador pare en un lloc específic del nostre codi, li ho hem d'indicar amb punts de ruptura o breakpoints. Per poder posar un breakpoint només hem de fer clic sobre el número de la línia sobre la que volem que s'apare l'execució del programa.  Per tal de llevar-lo tornem a punxar sobre la mateixa línia.</p>
<p>Una vegada hages provat el depurador de Processing IDE i tingues més o menys clar com funciona, fes l'activitat següent.</p>
<details class="question">
<summary>Activitat 8. Correcció d'errades amb el depurador</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="8:2"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio"/><input id="__tabbed_8_2" name="__tabbed_8" type="radio"/><div class="tabbed-labels"><label for="__tabbed_8_1">Problema</label><label for="__tabbed_8_2">Solució</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Com hauràs vist quan has executat el codi, el comportament del que fa el nostre codi amb la boleta no és el que esperavem, o almenys jo ho imaginava d'una altra manera. </p>
<p>Dona la sensació que cada vegada que la boleta apareix a la part de dalt de la pantalla de l'aplicació, va cada vegada més de pressa. Per què?</p>
<p>Revisa el codi, troba on està el problema i fes els canvis necessaris. Per facilitar la tasca, fes una depuració línia a línia del codi amb el <strong>Debugger</strong> de Processing IDE i deixa l'aplicació com a tu t'agradaria.</p>
<p>Pista: igual quan torna a apareixer per dalt el temps es deuria resetejar a 0 i començar de zero. Ho està fent així? Com ho podries canviar?</p>
</div>
<div class="tabbed-block">
<p><a href="assets/Activitat8.pde">Descarrega la solució de l'activitat 8</a></p>
</div>
</div>
</div>
</details>
<h4 id="estructura-de-seleccio-doble">Estructura de selecció doble</h4>
<p>Per tal de treballar <strong>l'estructura condicional doble</strong> que acabem de veure ampliarem les funcionalitats de la nostra aplicació. Ara volem que quan la boleta comence de tocar terra es pinte de color roig i redueixca la seua velocitat en l'eix y en un 50%. Quan no estiga tocant terra, que siga de color negre. Has de tindre en compte que la boleta es dibuixa a partir del seu center (posX, posY) i que per tant la boleta començarà a tocar terra quan la distància que hi ha entre el centre de la boleta i terra siga menor o igual que l'altura de la nostra aplicació més la meitat de la seua grandària.</p>
<p>El diagrama de flux amb els <strong>nous requeriments</strong> quedaria així:</p>
<div class="mermaid">graph LR
    Ini((Inici))--&gt;A[GRV=0.98f];
    style Ini fill:#0F0;
    A--&gt;B[Establir Dimensions<br/>Ample=640<br/>Alt=480];
    B--&gt;C[Establir Posició Inicial<br/>posX=random xMin, xMax<br/>posY=random yMin, yMax];
    C--&gt;D[Actualitzar Posició Bola<br/>vevY=velY + GRV*frameCount/frameRate<br/>posY=posY+velY];
    D--&gt;F{Ha tocat terra?};
    F--&gt;|SI|G[PintaRoig<br/>Frena Boleta];
    F--&gt;|NO|H[PintaNegre];
    G--&gt;P1(fa:fa-spinner);
    H--&gt;P1;
    P1--&gt;I{Ha desaparegut?};
    I--&gt;|SI|J[velY=0<br/>posY=-TAM/2<br/>frameCount=0];
    J--&gt;K[Dibuixar Bola];
    K--Draw: bucle joc--&gt;D;
</div>
<p>Estudia amb detall el diagrama de flux anterior i fes la següent activitat.</p>
<details class="question">
<summary>Activitat 9. Boleta de dos colors</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="9:2"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio"/><input id="__tabbed_9_2" name="__tabbed_9" type="radio"/><div class="tabbed-labels"><label for="__tabbed_9_1">Problema</label><label for="__tabbed_9_2">Solució</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Observa el diagrama de flux anterior i modifica el codi de que ja tens per tal d'afegir-li les noves funcionalitats. La distància a partir de la qual la boleta es faria roja és quan comença a tocar terra i per una altra banda has de comprovar també quan ha desaparegut completament. Concretament en el teu codi deuries tindre: una estructura de selecció  simple (la de l'activitat anterior) i una altra doble, la nova funcionalitat. Finalment l'aplicació quedaria de la següent forma:</p>
<p><center>
<img alt="Boleta" src="assets/act9.gif"/>
</center></p>
<p>Algunes consideracions: has de canviar el tipus de posX i posY a float per augmentar la precisió.</p>
</div>
<div class="tabbed-block">
<p>Encara no disponible
<a href="assets/Activitat9.pde">Descarrega la solució de l'activitat 9</a></p>
</div>
</div>
</div>
</details>
<h4 id="estructura-de-seleccio-niada">Estructura de selecció niada</h4>
<p>Com recordaràs el que hem donat al tema 3, l'estructura de selecció niada és una estructura de programació en la que poden haver més d'una condició. A l'activitat anterior teniem dues condicions: desapareixer i tocar terrà, en canvi no hem utilitzat l'estructura de selecció niada. Modifica el codi anterior i converteix una estructura simple i una doble en una estructura única estructura de selecció niada com mostra el següent diagrama de flux.</p>
<div class="mermaid">graph LR
    Ini((Inici))--&gt;A[GRV=0.98f];
    style Ini fill:#0F0;
    A--&gt;B[Establir Dimensions<br/>Ample=640<br/>Alt=480];
    B--&gt;C[Establir Posició Inicial<br/>posX=random Xmin, Xmax<br/>posY=random Ymin, Ymax];
    C--&gt;D[Actualitzar Posició Bola<br/>vevY=velY+GRV*frameCount/frameRate<br/>posY=posY+velY];
    D--&gt;F{Ha tocat terra<br/>i NO<br/>ha desaparegut?};
    F--&gt;|SI|G[PintaRoig<br/>Frena Boleta];
    G--&gt;K;
    F--&gt;|NO|H{Ha desaparegut?};
    H--&gt;|SI|I[velY=0<br/>posY=-TAM/2<br/>frameCount=0];
    I--&gt;K;
    H--&gt;|NO|J[PintaNegre];
    J--&gt;K[Dibuixar Bola];
    K--Draw: bucle joc--&gt;D;
</div>
<details class="question">
<summary>Activitat 10. Modifica el codi anterior</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="10:2"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio"/><input id="__tabbed_10_2" name="__tabbed_10" type="radio"/><div class="tabbed-labels"><label for="__tabbed_10_1">Problema</label><label for="__tabbed_10_2">Solució</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Observa el diagrama de flux anterior i modifica el codi de l'activitat 9 per tal que en lloc de tindre dues estructures condicionals en tinga una niada.</p>
<p><strong>Ampliació:</strong> Fes que la boleta canvie de color segons l'altura en la que es trobe, per exemple: els primers 50 pixels que siga negra, els següents siga taronja, a partir del pixel 100 i fins el 150 groga, i així successivament sempre sense modificar el comportament anterior.</p>
<p>Has d'entregar dos fitxers en aquesta activitat: <strong>Activitat10.pde i Activitat10Ampliada.pde</strong></p>
</div>
<div class="tabbed-block">
<p>Encara no disponible
<a href="assets/Activitat10.pde">Descarrega la solució de l'activitat 10</a></p>
</div>
</div>
</div>
</details>
<h4 id="estructura-de-seleccio-multiple">Estructura de selecció múltiple</h4>
<p>Treballem a continuació l'estructura de selecció múltiple: <strong>switch case</strong>. Per poder treballar amb el switch li afegirem alguna funcionalitat nova al nostre joc. Es tracta de poder interaccionar amb la boleta, és a dir, es pretén que quan premem al teclat algun cursor (dalt, baix, esquerra, dreta) la boleta es menege en eixa direcció o se li done alguna classe d'impuls cap a eixa direcció concreta.</p>
<p>Per poder aconseguir això hem d'usar un <strong>esdeveniment</strong> que ens ofereix la llibreria de <strong>Processing IDE</strong>. Aquest esdeveniment es diu <strong>keyPressed</strong> i ve en forma de funció en la que podem escriure tot el codi que necessite.</p>
<p>Abans de passar a fer l'activitat 11, entra al <strong>Reference de Processing IDE</strong>, investiga bé què és això del <strong>keyPressed</strong>, com funciona i quines coses es podrien fer.</p>
<details class="danger" open="open">
<summary>Algunes consideracions</summary>
<p>Abans de programar el codi necessari per controlar el moviment de la <strong>boleta</strong> a la següent activitat, has de fer-te lse següents qüestions:</p>
<ol>
<li>Què pense que passarà si prem un cursor qualsevol (amunt, avall, dreta o esquerra)?</li>
<li>Si vull que la boleta no pare de moure's, he de deixar el botó pres?</li>
<li>Si prem el botó dret només una vegada, es mourà només durant un frame o continuarà movent-se mentre no li indique el contrari?</li>
<li>Puc parar la boleta? Com ho faria?</li>
</ol>
</details>
<p>Per continuar amb el projecte de la boleta, canviarem un poc el diagrama de flux. Com pots observar a continuació, la gravetat ja no existeix, ara la boleta apareixerà al mig de la pantalla de la nostra aplicació i no començarà a moure's fins que premem algun cursor del teclat seguint la lògica del joc de la serp.</p>
<p>Per tal de poder implementar aquest tipus de moviment, necessitem de dues variables més que ens indiquen en quina direcció està anant la nostra boleta. Mira la taula següent.</p>
<table>
<thead>
<tr>
<th align="center">dirX</th>
<th align="center">dirY</th>
<th align="center">On Va</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">0</td>
<td align="center">0</td>
<td align="center">Parat</td>
</tr>
<tr>
<td align="center">0</td>
<td align="center">-1</td>
<td align="center">Avall</td>
</tr>
<tr>
<td align="center">0</td>
<td align="center">1</td>
<td align="center">Amunt</td>
</tr>
<tr>
<td align="center">1</td>
<td align="center">0</td>
<td align="center">Dreta</td>
</tr>
<tr>
<td align="center">-1</td>
<td align="center">0</td>
<td align="center">Esquerra</td>
</tr>
</tbody>
</table>
<p>D'altra banda el que abans era la velocitat, un vector de dues coordenades, passa a ser una magnitud entera, és a dir, només un sol valor.</p>
<p><center>
<div class="mermaid">graph LR
    Ini((Inici))--&gt;A[Establir Dimensions<br/>Ample=640<br/>Alt=480<br/>Establir Posició<br/>posX=320<br/>posY=240<br/>Establir Direcció<br/>dirX=0<br/>dirY=0<br/>Establir velocitat<br/>vel=3];
    style Ini fill:#0F0;    
    A--&gt;B[Actualitzar Posició\nposX+=dirX*vel\nposY+=dirY*vel];
    B--&gt;C[Dibuixar Bola];
    C--&gt;D{Tecla premuda?};
    D--&gt;|NO|C;
    D--&gt;|SI|E{Esdeveniment<br/>keyPressed};
    E--&gt;|UP|F[Amunt<br/>dirX=0\ndirY=-1];
    E--&gt;|DOWN|G[Avall<br/>dirX=0<br/>dirY=1];
    E--&gt;|LEFT|H[Esquerra<br/>dirX=-1<br/>dirY=0];
    E--&gt;|RIGHT|I[Dreta<br/>dirX=1<br/>dirY=0];
    F--&gt;J(fa:fa-spinner);
    G--&gt;J;
    H--&gt;J;
    I--&gt;J;
    J--Draw: bucle joc--&gt;C;
</div>
</center></p>
<details class="question">
<summary>Activitat 11. Boleta amb cursors</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="11:2"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio"/><input id="__tabbed_11_2" name="__tabbed_11" type="radio"/><div class="tabbed-labels"><label for="__tabbed_11_1">Problema</label><label for="__tabbed_11_2">Solució</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>A partir de l'activitat 9 li donarem interactivitat amb l'usuari a la nostra boleta.</p>
<p>Per fer la base del nostre joc, seguirem la lògica del joc de la serp com ja he comentat abans. Aquell joc en que una serp persegueix boletes que apareixen aleatòriament a la pantalla i conforme "se les menja" va creixent augmentant la dificultat (ja veurem com).</p>
<p>Completa el següent codi per tal que quan premem un cursor del nostre teclat, la boleta comence a menejar-se en eixa direcció. A l'inici de l'aplicació, la boleta estarà parada.</p>
<p><div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Variables globals</span>
<span class="kt">float</span><span class="w"> </span><span class="n">posX</span><span class="p">,</span><span class="w"> </span><span class="n">posY</span><span class="p">,</span><span class="w"> </span><span class="n">vel</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">dirX</span><span class="p">,</span><span class="w"> </span><span class="n">dirY</span><span class="p">;</span><span class="w"> </span>
<span class="c1">// Compte que ací hem afegit les variables dirX i dirY </span>
<span class="c1">// necessàries per indicar en quina direcció va la boleta</span>


<span class="c1">// Configuració de l'aplicació (només s'executa una vegada al principi)</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">setup</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">size</span><span class="p">(</span><span class="mi">640</span><span class="p">,</span><span class="mi">480</span><span class="p">);</span><span class="w">  </span><span class="c1">// Grandària de monitor estàndard VGA</span>
<span class="w">    </span><span class="n">posX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">320</span><span class="p">;</span>
<span class="w">    </span><span class="n">posY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">50</span><span class="p">;</span>
<span class="w">    </span><span class="n">dirX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">dirY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="n">vel</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">draw</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">background</span><span class="p">(</span><span class="mi">255</span><span class="p">);</span>
<span class="w">    </span><span class="n">ellipse</span><span class="p">(</span><span class="n">posX</span><span class="p">,</span><span class="w"> </span><span class="n">posY</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="mi">30</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">keyPressed</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">keyCode</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="n">UP</span><span class="p">:</span>
<span class="w">            </span><span class="c1">// Ací anirà el codi per que la boleta es menege cap amunt</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>

<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="n">DOWN</span><span class="p">:</span>
<span class="w">            </span><span class="c1">// Ací anirà el codi per que la boleta vaja cap avall.</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>

<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="n">LEFT</span><span class="p">:</span>
<span class="w">            </span><span class="c1">// Codi per moure la boleta cap a l'esquerra.</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>

<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="n">RIGHT</span><span class="p">:</span>
<span class="w">            </span><span class="c1">// Codi per moure la boleta cap a la dreta.</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<center>
<img alt="Boleta amb Cursors" src="assets/boletaAmbCursors.gif"/>
</center></p>
</div>
<div class="tabbed-block">
<p><a href="assets/Activitat11.pde">Descarrega la solució de l'activitat 11</a></p>
</div>
</div>
</div>
</details>
<h2 id="programacio-modular">Programació Modular</h2>
<p>Com has pogut observar en els diagrames de flux que hem anat fent al nostre projecte, va augmentant en complexitat i cada vegada són més difícils de interpretar. Ha arribat l'hora de <strong>modularitzar</strong> el nostre joc.</p>
<p>Basant-nos en el diagrama de flux anterior observa el següent diagrama simplificat.</p>
<p><center>
<div class="mermaid">graph LR
    Ini((Inici))--&gt;A[Inicialitzar App];
    style Ini fill:#0F0;
    A--&gt;B[Actualitzar Boleta];
    B--&gt;C[Dibuixar Bola];
    C--&gt;D[Comprovar Pulsacions<br/>keyPressed];
    D--Draw: bucle joc--&gt;C;    
</div>
</center></p>
<p>Com pots observar, hem simplificat molt el diagrama anterior però hauria de continuar funcionant igualment. El que hem fet ha sigut substituir els conjunts d'instruccions del diagrama anterior per funcionalitats més genèriques. Així:</p>
<p><strong>1. Inicialitzar App:</strong> s'encarregarà de establir dimensions, establir la posició i la direcció inicial de la boleta.<br/>
<strong>2. Actualitzar Boleta:</strong> s'encarregarà de en base als valors que tinguen dirX, dirY i velocitat de modificar els valors de posX i posY com hem vist en activitats anteriors.<br/>
<strong>3. Dibuixar boleta:</strong> s'encarregarà de dibuixar la boleta al lloc de l'aplicació que li corresponga.<br/>
<strong>4. Comprovar pulsacions:</strong> s'encarregarà de gestionar els esdeveniments de teclats. Bàsicament seria *<em>keyPressed.</em><br/></p>
<details class="question">
<summary>Activitat 12. Modularitza el codi del projecte</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="12:2"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio"/><input id="__tabbed_12_2" name="__tabbed_12" type="radio"/><div class="tabbed-labels"><label for="__tabbed_12_1">Problema</label><label for="__tabbed_12_2">Solució</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Seguint a partir del codi que hem desenvolupat a l'activitat 11, has de modularitzar el codi creant les següents funcions: inicialitzarJoc, actualitzarPosicio, dibuixar.</p>
<p>De moment la funcionalitat de <strong>comprovar pulsacions</strong> s'encarregarà el mètode de l'API de Processing <strong>keyPressed</strong>.</p>
</div>
<div class="tabbed-block">
<p>Encara no disponible
<a href="assets/Activitat12.pde">Descarrega la solució de l'activitat 12</a></p>
</div>
</div>
</div>
</details>
<h3 id="parametres">Paràmetres</h3>
<p>Com hem vist al tema 4, les funcions en programació permeten la seua parametrització, és a dir, poder condicionar el funcionament dels mètodes mitjançant l'ús de paràmetres i arguments. La qüestió és si podem o no utilitzar aquesta característica de la programació modular a la nostra aplicació. </p>
<p>Normalment la parametrització de mètodes serveix entre altres coses per evitar l'ús de les variables globals que a la llarga solen portar problemes.  En el nostre cas de moment algunes variables com les de posició i direcció de la boleta no podem evitar que siguen globals, però hi ha altres que igual seria convenient que no ho foren.</p>
<p>Llig i fes l'activitat 13.</p>
<details class="question">
<summary>Activitat 13. Parametrització de funcions</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="13:2"><input checked="checked" id="__tabbed_13_1" name="__tabbed_13" type="radio"/><input id="__tabbed_13_2" name="__tabbed_13" type="radio"/><div class="tabbed-labels"><label for="__tabbed_13_1">Problema</label><label for="__tabbed_13_2">Solució</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Revisa el codi que has escrit a l'activitat 12 de modularització i raona el següent.
Hi ha algun mètode dels que he has escrit que siga susceptible de ser parametritzat?</p>
<p>Reescriu el codi parametritzant les funcions que consideres necessàries i raona el motiu en els comentaris de documentació al codi.</p>
</div>
<div class="tabbed-block">
<p>Encara no disponible
<a href="assets/Activitat13.pde">Descarrega la solució de l'activitat 13</a></p>
</div>
</div>
</div>
</details>
<h3 id="pas-dobjectes-a-funcions">Pas d'objectes a funcions</h3>
<p>Un dels apartats que hem vist al tema de programació modular és l'ús d'objectes i funcions. Com que nosaltres encara no hem entrat en <strong>Programació Orientada a Objectes</strong> no entrarem massa en detall del que és una classe, un objecte i/o una instància però sí que ens introduirem un poc en el món dels objectes.</p>
<p>Anem a utilitzar l'objecte <a href="https://processing.org/reference/PVector.html">PVector</a> que ens proporciona l'API de Processing per treballar amb vectors de coordenades. </p>
<p>Llig l'article <a href="https://processing.org/reference/PVector.html">PVector</a> de la guia de Processing IDE i després fes la següent activitat.</p>
<p>Has de tenir en compte que encara que els vectors de posició i direcció siguen variables globals, s'haurien de passar per paràmetre a aquells mètodes que ho necessiten.</p>
<details class="question">
<summary>Activitat 14. Ús d'objectes i funcions</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="14:2"><input checked="checked" id="__tabbed_14_1" name="__tabbed_14" type="radio"/><input id="__tabbed_14_2" name="__tabbed_14" type="radio"/><div class="tabbed-labels"><label for="__tabbed_14_1">Problema</label><label for="__tabbed_14_2">Solució</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Com hauràs llegit a l'article <strong>PVector</strong> és una classe que s'utilitza  per representar vectors de dos o tres dimensions. En el nostre cas necessitariem fer ús del vector de dues dimensions per raons obvies.</p>
<p>Hauries de declarar dos PVectors, un per la posició de la boleta i un altre per a la direcció de la boleta.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Exemple de com es declara un objecte de la classe PVector</span>
<span class="n">PVector</span><span class="w"> </span><span class="n">nomVector</span><span class="p">;</span>

<span class="c1">// Exemple de com s'inicia un objecte de la classe PVector</span>
<span class="n">nomVector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PVector</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">);</span><span class="w">  </span>
<span class="c1">// On 'a' i 'b' són els valors que s'assignaran a la coordenada x i y respectivament.</span>

<span class="c1">// També es podria declarar un vector buit i assignar-li les coordenades a posteriori</span>
<span class="n">nomVector</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PVector</span><span class="p">();</span>
<span class="n">nomVector</span><span class="p">.</span><span class="na">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="n">nomVector</span><span class="p">.</span><span class="na">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
</code></pre></div></td></tr></table></div>
</div>
<div class="tabbed-block">
<p><a href="assets/Activitat14.pde">Descarrega la solució de l'activitat 14</a></p>
</div>
</div>
</div>
</details>
<h3 id="sobre-el-return">Sobre el return</h3>
<p>Si has arribat a aquest punt, segurament t'hauràs donat compte que la boleta quan arriba a algun dels extrems de la pantalla: dalt, baix, esquerra o dreta; la boleta desapareix i no torna a apareixer a no ser que li canviem la direcció i posem la contraria que tenia quan ha desaparegut.</p>
<p>Per tal de solucionar aquest problema crearem un mètode <strong>superaLimits</strong> que s'encarregarà per a cada frame de comprovar si la boleta ha superat algun dels límits del nostre joc. Aquest mètode bàsicament farà el següent:</p>
<p><center>
<div class="mermaid">graph LR
    Ini((Inici))--&gt;A{Supera<br/>límit superior?};
    style Ini fill:#0F0;
    A--&gt;|SI|B[return true];
    A--&gt;|NO|C{Supera<br/>límit inferior?};
    C--&gt;|SI|B;
    C--&gt;|NO|D{Supera<br/>límit esquerre?};
    D--&gt;|SI|B;
    D--&gt;|NO|E{Supera<br/>límit dret?};
    E--&gt;|SI|B;
    E--&gt;|NO|F[return false];
    F--&gt;Fin((Fi));
    style Fin fill:#F00;
    B--&gt;Fin;
</div>
</center></p>
<p>Finalment només ens quedaria saber que fer quan la boleta a arribat algun dels límits de la pantalla. S'hauria de parar? Hauria de rebotar? En cas de rebotar, en quina direcció ho faria? Des del meu punt de vista i amb la idea de joc que es preten fer, si la boleta toca un límit, haurà de rebotar en direcció contraria.  Per exemple, si la boleta va en direcció dreta (dirX=1, dirY=0) hauria de rebotar cap a l'esquerra (dirX=-1, dirY=0). Si pel contrari, la boleta va cap avall (dirX=0, dirY=1) passarà a anar cap amunt (dirX=0, dirY=-1).  Com pots observar, rebotar significa multiplicar per menys ú la direcció actual de la boleta, per tant podem concloure que el diagrama de flux final d'aquesta activitat quedaria de la següent forma.</p>
<p><center>
<div class="mermaid">graph LR
    Ini((Inici))--&gt;A[Inicialitzar App];
    style Ini fill:#0F0;
    A--&gt;B[Actualitzar Boleta];
    B--&gt;C[Dibuixar Bola];
    C--&gt;D[Comprovar Pulsacions<br/>keyPressed];
    D--&gt;E{SuperaLimit?}
    E--&gt;|Si|F[Rebota];
    E--&gt;|No|B;
    F--&gt;B;        
</div>
</center></p>
<p>El que sí està clar és que la funció ha de tornar un valor booleà que ens indique si la boleta ha superat algun marge (true) o no (false)</p>
<details class="question">
<summary>Activitat 15. Detecció de vores</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="15:2"><input checked="checked" id="__tabbed_15_1" name="__tabbed_15" type="radio"/><input id="__tabbed_15_2" name="__tabbed_15" type="radio"/><div class="tabbed-labels"><label for="__tabbed_15_1">Problema</label><label for="__tabbed_15_2">Solució</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Seguint el exemple que hem posat al diagrama de flux anterior, dissenya una funció que es podria dir <strong>superaLimits</strong> que ens retorne un valor true en cas que la boleta desaparega per algun límit i false en cas contrari.</p>
<p>En el bucle de joc hauràs de cridar a dita funció per comprovar a cada frame si la boleta toca o no algun límit de l'aplicació. Al mateix temps segons la resposta (true o false) que ens done la crida al mètode <strong>superaLimits</strong> haurem de prendre la decisió de què fem amb ella: parar, rebotar..</p>
<p>Segueix el diagrama de flux anterior i implementa l'activitat.</p>
<p><center>
<img alt="Boleta amb Cursors" src="assets/bolaRebota.gif"/>
</center></p>
</div>
<div class="tabbed-block">
<p>Encara no disponible
<a href="assets/Activitat15.pde">Descarrega la solució de l'activitat 15</a></p>
</div>
</div>
</div>
</details>
<h2 id="tipus-compostos-de-dades">Tipus Compostos de Dades</h2>
<p>Aprofitant que al tema de tipus compostos de dades hem vist algunes col·leccions o conjunts (arrays i matrius), veiem com podem afegir-li més funcionalitats al nostre projecte de la boleta.</p>
<p>Com que ja podem moure la boleta per la pantalla de la nostra aplicació amb els cursors, donem-li un objectiu al nostre personatge. Farem que la finalitat del joc siga que la nostra boleta persegueixi i <strong>es "menge" enemics</strong>. </p>
<p>Suposem que aquests enemics són <strong>cercles d'un color diferent</strong> al de la boleta que apareixen de forma aleatòria per la pantalla i es <strong>mantenen en la mateixa posició</strong> durant tot el joc, a més a més, en el moment que apareixen la boleta els ha de tocar per poder eliminar-los. Podriem fer, per exemple, que els enemics <strong>comencen a apareixer passat un temps</strong> i que vagen apareixent fins arribar a un màxim de 10 enemics en total. </p>
<p>El joc <strong>acaba</strong> quan la boleta s'haja "menjat" a tots els enemics.</p>
<p>Analitzem amb més profunditat el plantejament anterior i vegem quins podrien ser els seus requeriments. </p>
<h3 id="requeriments">Requeriments</h3>
<ol>
<li>Hem de guardar informació sobre la posició dels enemics igual que feiem anb la boleta.</li>
<li>Els enemics apareixen de forma aleatòria (posició) a la pantalla cada cert temps (interval) constant.</li>
<li>Els enemics són estàtics. No es poden moure i mantenen sempre la mateixa posició. Simple de moment.</li>
<li>Hi haurà un màxim de 10 enemics de forma simultània al nostre joc.</li>
<li>Per "menjar-se" un enemic, la boleta haurà de <strong>col·lisionar</strong> amb l'enemic, és a dir, tocar-lo.</li>
<li>El joc finalitza quan la boleta s'ha menjat a tots els enemics.</li>
</ol>
<p>D'alguna manera hem de poder guardar la informació necessària d'un <strong>conjunt</strong> d'enemics al nostre programa. Sembla lògic que usarem un array d'una dimensió per aquesta tasca, però quin tipus de dades ha de guardar aquest array. Si ho penses bé dels enemics només necessitem saber-ne la posició en la que es troben, és a dir, podriem usar un <strong>array de PVectors.</strong></p>
<h3 id="diagrama-de-flux">Diagrama de flux</h3>
<p>Veiem a continuació un possible <strong>disseny</strong> de les ampliacions de funcionalitats del nostre joc al <strong>diagrama de flux</strong></p>
<p><center>
<div class="mermaid">graph LR
    Ini((Inici))--&gt;A["Inicialitzar App<br/>(setup)"];
    style Ini fill:#0F0;
    A--&gt;B["Actualitza Boleta<br/>(draw)"];
    B--&gt;C["Actualitza Enemics<br/>(draw)"];
    C--&gt;D["Dibuixa Boleta<br/>(draw)"];
    D--&gt;E["Dibuixa Enemics<br/>(draw)"];
    E--&gt;F["Comprovar col·lisions<br/>(draw)"];
    F--&gt;G["Comprovar pulsacions<br/>(keyPressed)"];
    G--&gt;H{Queden enemics?};
    H--&gt;|Si|I{Supera Limit?};
    H--&gt;|No|J[Finalitzar Joc];
    I--&gt;|Si|K[Rebota];
    I--&gt;|No|B;    
    J--&gt;Fi((Fi));
    style Fi fill:#F00;
    K--&gt;B;        
</div>
</center></p>
<p>Com es pot observar al diagrama de flux anterior hi han poques diferències amb el que haviem fet a l'activitat 15. Apareixen les següents novetats: </p>
<ul>
<li><strong>Instruccions: </strong> Actualitzar enemics, Dibuixar enemics, Comprovar col·lisions, Finalitzar Joc.</li>
<li><strong>Condicions: </strong> Queden enemics?</li>
</ul>
<p>En realitat, com ja hauràs imaginat, eixes noves instruccions en realitat <strong>són mètodes nous</strong> del nostre joc. Expliquem-los amb més detall:</p>
<p><strong>1. Actualitzar enemics:</strong> aquest mètode s'encarrega de gestionar la llista d'enemics assignant-los cada un cert interval de temps una posició a aquells que encara no hagen aparegut que no es modificarà durant tot el joc fins que se'l mengen. En definitiva, aquest mètode és el que porta el control del temps per tal d'anar assignant posicions aleatòries als enemics que van apareixent. També ha de tindre en compte que només es poden mostrar un màxim de 10 enemics al nostre joc.</p>
<p><center>
<div class="mermaid">    graph LR
    Ini((Inici))--&gt;A{Queden enemics<br/>per mostrar?};
    style Ini fill:#0F0;
    A--&gt;|Si|B{Han passat<br/>'x' segons?};
    A--&gt;|No|Fi((Fi));
    style Fi fill:#F00;
    B--&gt;|Si|C[Genera posició nova<br/>Guarda posició<br/>Incrementa contEnemics];
    C--&gt;A;
    B--&gt;|No|B;
</div>
</center></p>
<p><strong>2. Dibuixar enemics:</strong> aquest mètode haurà de recórrer l'array amb les posicions dels enemics, en cas d'haver-ne alguna (recorda que és actualitzar enemics la que s'encarrega d'açò) i dibuixar els cercles (enemics) corresponents. </p>
<p><center>
<div class="mermaid">    graph LR
    Ini((Inici))--&gt;A[Obté Enemic de l'array];
    style Ini fill:#0F0;
    A--&gt;B[Dibuixa enemic];
    B--&gt;C{Queden enemics<br/>per mostrar?};
    C--&gt;|Si|A;
    C--&gt;|No|Fi((Fi));
    style Fi fill:#F00;
</div>
</center></p>
<p><strong>3. Comprovar col·lisions:</strong> aquest és possiblement el mètode més complex. A cada cicle del bucle del joc s'haurà de comprovar si la nostra boleta, com a conseqüència de la seua nova posició una vegada ja s'ha actualitzat, està col·lisionant amb algun enemic. Per saber si la boleta està col·lisionant amb algun enemic es pot saber de la següent manera: si la distància entre la posició de la boleta i la posició de l'enemic és menor que la suma del radi de la boleta i el de l'enemic, significa que s'estan tocant i per tant s'hauria d'eliminar l'enemic.  Per poder realitzar aquests càlculs pots aprofitar les funcionalitats que ens ofereix el PVector de l'API de Processing. </p>
<p><center>
<div class="mermaid">    graph LR
    style Ini fill:#0F0;
    Ini((Inici))--&gt;A[Obté Enemic de l'array];
    A--&gt;B{dist entre<br/>enemic i boleta<br/>menor que<br/>suma radis?};
    B--&gt;|Si|C[Elimina];
    C--&gt;A;
    B--&gt;|No|D{Queden enemics?};
    D--&gt;|Si|A;
    D--&gt;|No|Fi((Fi));
    style Fi fill:#F00;
</div>
</center></p>
<p><strong>4. Queden enemics:</strong> en aquesta condició s'ha de comprovar si ja hem menjat a tots els enemics i en aquest cas finalitzariem el joc. Compte que fins que no apareix el primer enemic es podria pensar que ja no queden enemics i finalitzar el joc sense haver-lo començat. Has de dissenyar bé aquest mètode per tal que això no passe. La millor forma es amb un comptador d'enemics morts que seria zero a l'inici de l'aplicació i 10 quan ens els hajam menjat a tots. El comptador de morts s'actualitzarà cada vegada que es detecte una col·lisió i es mate un enemic.</p>
<p>En aquesta funció es podria aprofitar per mostrar un comptador per pantalla on s'indique el total d'enemics que s'ha menjat la boleta. </p>
<p><strong>5. Finalitzar joc:</strong> és un mètode que s'encarregaria de fer veure a l'usuari que la partida ja ha finalitzat, és a dir, el típic <strong>Gave Over</strong>.  Bàsicament és una condició en alguna part del codi on es comprove si el total de morts és igual a 10, en cas de ser així, es mostrarà un missatge de <strong>GAME OVER</strong> enmig de la pantalla.</p>
<p>Alguns dubtes que potser t'estaràs preguntant:</p>
<ul>
<li><strong>Com guarde informació de la posició dels enemics?</strong>
Has d'utilitzar un array de PVectors com s'ha comentat abans amb capacitat per a 10 elements. Cadascun d'aquests PVectors tindran la informació de la posició d'un enemic. En cas que aquest siga null significaria que encara no ha aparegut.</li>
<li><strong>En quin moment comence a mostrar enemics?</strong> Has de portar un control del temps, una bona manera pot ser utilitzar la variable frameCount de Processing però també hi ha altres alternatives com les funcions de temps de l'API de Processing. Per exemple, cada 60 frames podries considerar que ha passat un segon, encara que no seria massa precís. Mira les funcions de temps que ens permet usar Processing perquè es pot utilitzar també més endavant per fer un comptador de temps. Per exemple imagina que l'interval en el que apareixen els enemics és de 200 frames o de 5 segons, el primer enemic apareixeria passats 200 frames o 5 segons des de l'inici de l'aplicació. Una vegada a aparegut el primer enemic esperaria uns altres 200 frames o 5 segons per mostrar el següent i així successivament.</li>
<li><strong>Com se si han aparegut o no?</strong> Com que tens un array de PVectors que t'indica la posició de tots els enemics, és fàcil deduir que si el contingut en la posició 2 de l'array és nul·la significa que encara no ha aparegut.</li>
<li><strong>Com s'eliminen enemics?</strong> Posant a null el contingut de l'array de PVectors seria una opció.</li>
<li><strong>Com se si ja els he eliminat a tots?</strong> Deuries portar un comptador de col·lisions. Amb una variable global es podria solucionar.</li>
</ul>
<details class="question">
<summary>Activitat 16. Gestió d'enemics</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="16:2"><input checked="checked" id="__tabbed_16_1" name="__tabbed_16" type="radio"/><input id="__tabbed_16_2" name="__tabbed_16" type="radio"/><div class="tabbed-labels"><label for="__tabbed_16_1">Problema</label><label for="__tabbed_16_2">Solució</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>A partir de l'especificació de requeriments anterior i el diagrama de flux de les noves funcionalitats del nostre joc. Implementa-les i afegeix-les al teu codi del projecte de la boleta.  </p>
<p>Recorda que hauran d'apareixer de forma aleatòria i cada cert temps un màxim de 10 enemics que la nostra boleta s'haurà de menjar per considerar el joc acabat.</p>
<p>Els arrais s'han de utilitzar i declarar de forma "manual" com hem vist a classe.</p>
</div>
<div class="tabbed-block">
<p>Encara no disponible</p>
</div>
</div>
</div>
</details>
<!--[Descarrega la solució de l'activitat 16](assets/Activitat15.pde)-->
<details class="question">
<summary>Activitat 17. Gestió d'enemics utilitzant col·leccions i iteradors</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="17:1"><input checked="checked" id="__tabbed_17_1" name="__tabbed_17" type="radio"/><div class="tabbed-labels"><label for="__tabbed_17_1">Problema</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Modifica l'activitat anterior per tal d'utilitzar alguna de les col·leccions que ens facilita l'API de Java.</p>
</div>
</div>
</div>
</details>
<h2 id="programacio-orientada-a-objectes">Programació orientada a objectes</h2>
<p>Canviem el paradigma de programació del nostre joc de la boleta. Si fins ara el que hem fet ha sigut imaginar un conjunt de procediments que hem programat basant-nos en el paradigma de programació estructurada, ara hem de fer el procés d'abstracció de la nostra aplicació i veure-la com un conjunt d'objectes que tenen un comportament concret. Però comencem pel principi i seguim els passos que hem vist al Tema 6.</p>
<p><strong>1. <ins>Quins elements de la nostra aplicació han de ser desats o s'han de tenir en compte?</ins></strong></p>
<ul>
<li>La boleta, els enemics i un marcador <strong>(nou)</strong> que ens indicarà tant el temps com les puntuacions (enemics mostrats i morts)</li>
</ul>
<p><strong>2. <ins>De cada element, quines dades ens interessen?</ins></strong></p>
<ul>
<li><strong>Boleta:</strong> color, posició, direcció, velocitat, color, grandària. </li>
<li><strong>Enemic:</strong> posicio, color, grandaria.</li>
<li><strong>Marcador:</strong> posició, dimensions, temps transcorregut, interval (temps entre que apareix un enemic i el següent), pròxim interval (quan podrà tornar a apareixer un enemic), marcadors (punts)...</li>
</ul>
<p><strong>3. <ins>A cada element, quines operacions associarem?</ins></strong></p>
<ul>
<li><strong>Boleta:</strong> mostrar-se, actualitzar-se, moure's cap amunt, avall, dreta i esquerra, col·lisionar amb Enemics, rebotar, parar..</li>
<li><strong>Enemic:</strong> mostrar-se, morir.</li>
<li><strong>Marcador:</strong> mostrar-se, actualitzar-se, controlar el temps i els marcadors dividits en dos: puntsA que serà el total d'enemics mostrats i puntsB que seran els que ja hem eliminat.</li>
</ul>
<p>El fet de que el <strong>marcador</strong> parle de puntsA i puntsB en lloc de enemics apareguts i morts és perquè l'objecte marcador no ha de saber el significat dels valors que mostra (puntsA i puntsB) per tal de fer-lo més genèric i més reutilitzable a altres aplicacions.</p>
<p>De les respostes a les qüestions anteriors, el que hauriem de fer ara és dissenyar un xicotet <strong>diagrama de classes</strong> que represente la realitat anterior. Per exemple:</p>
<p><center>
<div class="mermaid">    classDiagram
    direction LR
    Bola: int grandaria
    Bola: float velocitat
    Bola: color pinta
    Bola: PVector posicio
    Bola: PVector direccio
    Bola: Bola()
    Bola: Bola(Pvector pos, Pvector dir, float vel, int tam, color col)
    Bola: void mostra()
    Bola: void actualitza()
    Bola: void para()
    Bola: boolean colisionaAmb (Enemic e)
    Bola: boolean superaLimits (int alt, int ample)
    Bola: void giraDreta()
    Bola: void giraEsquerra()
    Bola: void giraDalt()
    Bola: void giraBaix()

    Enemic: PVector posicio
    Enemic: int grandaria
    Enemic: color pinta
    Enemic: Enemic()
    Enemic: void mostra()
    Enemic: PVector getPosicio()
    Enemic: int getGrandaria()

    Marcador: int ample
    Marcador: int alt
    Marcador: PVector posicio
    Marcador: int currentTime
    Marcador: int timeLapse
    Marcador: int nextLapse
    Marcador: int puntsA
    Marcador: int puntsB
    Marcador: String lblPuntsA
    Marcador: String lblPuntsB
    Marcador: bool passatInterval
    Marcador: Marcador()
    Marcador: Marcador(String strA, String strB, int lapse)
    Marcador: void mostra()
    Marcador: void actualitza()
    Marcador: void sumaPuntsA()
    Marcador: void sumaPuntsB()
    Marcador: int getPuntsA()
    Marcador: int getPuntsB()
    Marcador: String getTime()
    Marcador: boolean haPassatInterval()

    Main "1" --&gt; "1" Bola
    Main "1" --&gt; "10" Enemic
    Main "1" --&gt; "1" Marcador
    Main: int maxEnemics=10
    Main: void setup()
    Main: void draw()
    Main: inicilialitzaApp()
    Main: keyPressed()
    Main: keyReleased()

</div>
</center></p>
<p>A partir d'aquest diagrama de classes ara ens quedaria implementar-les en Processing IDE per desprès poder utilitzar-les des de l'aplicació principal.
Per tal de poder utilitzar les classes creades al pas anterior, podriem implementar una aplicació <strong>main</strong> com la que mostra el següent diagrama de flux:</p>
<div class="mermaid">graph LR

    subgraph "GESTIÓ MARCADOR"
        style Ini fill:#0F0;    
        Ini((Inici))--&gt;A[Mostra Marcador];
        A--&gt;B{Queden enemics<br/>per matar?};
        B--&gt;|Si|C[Actualitza Marcador];
        C--&gt;D{Queden enemics<br/>per mostrar<br/>Y<br/>Ha passat<br/>un interval?};
        D--&gt;|Si|E[Crea Enemic<br/>Afegeix-lo<br/>Suma Apareguts];

    end

    subgraph "GESTIÓ DE LA BOLETA"
        D--&gt;|No|F;
        E--&gt;F[Mostra Bola<br/>Actualitza Bola];
        F--&gt;G{Supera Limits?};
        G--&gt;|Si|H[Rebota];
    end

    subgraph "GESTIÓ DELS ENEMICS"
        G--&gt;|No|I;
        H--&gt;I{Hi han enemics<br/>per mostrar?};
        I--&gt;|Si|J[Mostra Enemic];
        I--&gt;|No|B;
        J--&gt;K{Col·lisiona amb la boleta};
        K--&gt;|Si|L[Elimina Enemic<br/>Suma Punts];
        L--&gt;I;
        K--&gt;|No|I;
    end

    classDef primer fill:#EFF, clear:both, display:inline, clear: both
    class 1 primer
    class 2 primer
    class 3 primer
    class 4 primer

</div>
<p>Al final el resultat podria ser de la següent manera:</p>
<p><center>
<img alt="Joc de les boletes amb Enemics (POO)" src="assets/JocBoleta17.gif" style="height:350px;border:1px solid silver;"/>
</center></p>
<details class="question">
<summary>Activitat 18. Conversió a POO</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="18:2"><input checked="checked" id="__tabbed_18_1" name="__tabbed_18" type="radio"/><input id="__tabbed_18_2" name="__tabbed_18" type="radio"/><div class="tabbed-labels"><label for="__tabbed_18_1">Problema</label><label for="__tabbed_18_2">Solució</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Converteix el joc de la boleta al paradigma de programació orientada a objectes. Intenta seguir els passos que s'han explicat al tema 6 amb l'exemple del volcà que són els mateixos que acabem d'explicar a l'apartat anterior. </p>
</div>
<div class="tabbed-block">
<p>Encara no disponible</p>
</div>
</div>
</div>
</details>
<!--[Descarrega la solució de l'activitat 17](assets/Activitat17.zip)-->
<h2 id="classe-animator-reutilitzacio-de-classes">Classe Animator - Reutilització de classes</h2>
<p>Fins ara els elements que hem usat per fer el nostre joc de la boleta són figures geomètriques estàtiques el que fa que en general siga un poc avorrit. En aquest següent apartat aprendrem com convertir els nostres objectes en figures animades. Aprofitant una de les característiques principals del paradigma de Programació Orientada a Objectes, la reutilització del codi, incorporarem una nova classe al nostre joc: la classe <strong>Animation</strong> que podeu descarregar <a href="assets/AnimationOld.pde">Ací</a>. Aquesta classe ens permet mitjançant l'ús de <strong>sprite sheets</strong> crear animacions per al nostre personatge com la següent:</p>
<p><center>
<img alt="Exemple d'ús de la classe Animation" src="assets/Trump.gif" style="height:250px;border:1px solid silver;"/>
</center></p>
<p>Utilitzar aquesta classe és relativament senzill:</p>
<ol>
<li>Incorporem la classe al nostre projecte copiant-la a la mateixa carpeta com una classe pròpia més.</li>
<li>Declarem un atribut Animation a qualsevol classe del nostre projecte que volem animar.</li>
<li>Al constructor de la classe que volem animar instanciem l'objecte animation seguint les instruccions de la classe.</li>
</ol>
<h3 id="exemple-dus-de-la-classe-animation">Exemple d'ús de la classe Animation</h3>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">Animation</span><span class="w"> </span><span class="n">trump</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">setup</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">size</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span><span class="mi">200</span><span class="p">);</span>
<span class="w">    </span><span class="n">trump</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Animation</span><span class="w"> </span><span class="p">(</span><span class="s">"Trump"</span><span class="p">,</span><span class="w"> </span><span class="s">"./img/trump_run.png"</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">draw</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">clear</span><span class="p">();</span>
<span class="w">    </span><span class="n">background</span><span class="p">(</span><span class="mi">235</span><span class="p">);</span>

<span class="w">    </span><span class="n">trump</span><span class="p">.</span><span class="na">display</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">PVector</span><span class="p">(</span><span class="n">width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">height</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="n">trump</span><span class="p">.</span><span class="na">update</span><span class="p">();</span>
<span class="p">}</span><span class="w"> </span>
</code></pre></div></td></tr></table></div>
<p>Senzill no? Però com aconseguim que la nostra boleta es convertisca en un personatge animat com el de l'exemple anterior? Hem d'afegir un nou atribut a la nostra classe Boleta, aquest nou membre s'instanciarà al constructor de la classe Boleta i finalment al mètode mostrar de la boleta és on cridarem al mètode display de l'animació, finalment al mètode actualitza de la boleta és des d'on cridarem al mètode update de l'animació.</p>
<p>Però abans d'anar per feina, observem bé l'spritesheet:</p>
<p><center>
<img alt="Sprite Sheet Trump" src="assets/trump_run.png" style="height:320px;border:1px solid silver;"/>
</center></p>
<p>Amb el constructor amb el que hem instanciat el nostre objecte trump li indiquem els següents arguments: 
- "Trump": etiqueta que s'utilitza per identificar els frames de l'animació.
- "./imt/trump_run.png": ruta del nostre full d'sprites.
- 100: ample de cada frame de l'animació (cada Trumpet)
- 100: alt de cada frame de l'animació (cada Trumpet)
- 4: files de l'sprite sheet
- 6: columnes de l'sprite sheet
- 0: aquest argument ens indica si només volem agafar una fila (nombre de la fila que volem) per full o totes les files (zero). Al nostre cas hem posta zero el que significa que volem que l'animació carregue tots els frames de l'spritesheet.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="n">Animation</span><span class="w"> </span><span class="n">trump</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Animation</span><span class="w"> </span><span class="p">(</span><span class="s">"Trump"</span><span class="p">,</span><span class="w"> </span><span class="s">"./img/trump_run.png"</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</code></pre></div></td></tr></table></div>
<p>Com he dit, el que hem fet ha sigut carregar tot l'sprite sheet en una sola animació quan en realitat el que tenim és un full d'sprites amb quatre animacions com mostra la següent imatge. Cada fila és una animació diferent.</p>
<p><center>
<img alt="Sprite Sheet Trump - Explicació de les animacions" src="assets/trump_run_explicat.png" style="height:320px;border:1px solid silver;"/>
</center></p>
<p>El que hauriem de fer per tant és que la nostra classe Trump no tinga només un atribut animation com fins ara sino que tinga quatre atributs de la classe Animation per a simular cadascun dels diferents moviments que pot fer el nostre personatge. També necessitarem una última animació que ens servirà per indicar quina és l'animació actual o la que s'estiga executant en un moment concret. Finalment ens quedaria implementar el codi necessari per que quan el personatge canvie de direcció ho faja també l'animació que s'està executant. Això ho fariem als diferents mètodes <strong>gira</strong> que hem implementat a la classe boleta.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Teniu en compte que animAvall, animDreta, animAmunt, currentAnim són nous atributs de la classe Bola</span>
<span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">carregaAnimacions</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">animAvall</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Animation</span><span class="w"> </span><span class="p">(</span><span class="s">"Trump"</span><span class="p">,</span><span class="w"> </span><span class="s">"./img/trump_run.png"</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">animDreta</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Animation</span><span class="w"> </span><span class="p">(</span><span class="s">"Trump"</span><span class="p">,</span><span class="w"> </span><span class="s">"./img/trump_run.png"</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">animAmunt</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Animation</span><span class="w"> </span><span class="p">(</span><span class="s">"Trump"</span><span class="p">,</span><span class="w"> </span><span class="s">"./img/trump_run.png"</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">animEsquerra</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Animation</span><span class="w"> </span><span class="p">(</span><span class="s">"Trump"</span><span class="p">,</span><span class="w"> </span><span class="s">"./img/trump_run.png"</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">currentAnim</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">animAvall</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">giraDreta</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">direccio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PVector</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">currentAnim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">animDreta</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">giraEsquerra</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">    </span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">direccio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PVector</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">);</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">currentAnim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">animEsquerra</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">giraDalt</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">direccio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PVector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">currentAnim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">animAmunt</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">giraBaix</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">direccio</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PVector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">currentAnim</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">animAvall</span><span class="p">;</span>
<span class="p">}</span>

<span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">mostra</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">fill</span><span class="p">(</span><span class="n">pinta</span><span class="p">);</span>
<span class="w">    </span><span class="n">strokeWeight</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">currentAnim</span><span class="p">.</span><span class="na">display</span><span class="p">(</span><span class="n">posicio</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">actualitza</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">posicio</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">direccio</span><span class="p">.</span><span class="na">copy</span><span class="p">().</span><span class="na">mult</span><span class="p">(</span><span class="n">velocitat</span><span class="p">));</span>
<span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">currentAnim</span><span class="p">.</span><span class="na">update</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>El resultat de les modificacions al codi anteriors seria el següent:</p>
<p><center>
<img alt="Sprite Sheet Trump - Ús de les animacions" src="assets/trumpAnims.gif" style="height:350px;border:1px solid silver;"/>
</center></p>
<h3 id="ampliacio-del-marcador">Ampliació del marcador</h3>
<p>Per als pròxims apartats d'aquest projecte s'ha ampliat la classe marcador i se li ha afegit una etiqueta extra i un compte enrere. Aquesta modificació es per a poder usar elements tipus booster que acceleren al nostre personatge només per un període de temps. Se li ha afegit també un sistema d'alarmes com un array d'objectes JSON per poder afegir més d'una alarma a diferència del que estava fent a l'activitat anterior. Observa el següent diagrama:</p>
<p><center>
<div class="mermaid">        classDiagram
        direction LR
        Marcador: PVector posicio
        Marcador: int ample
        Marcador: int alt
        Marcador: int currentTime
        Marcador: int currentCountDown
        Marcador: int countDownFlag
        Marcador: int score
        Marcador: String lblPuntsA
        Marcador: String lblPuntsB
        Marcador: String lblExtra
        Marcador: int puntsA
        Marcador: int puntsB
        Marcador: JSONArray alarmes
        Marcador: Marcador()
        Marcador: Marcador(String strA, String strB)
        Marcador: void mostra()
        Marcador: void actualitza()
        Marcador: void afegirAlarma(String text, int durada, boolean esRepeteix)
        Marcador: ArrayList obtenirAlarmesDisparades()
        Marcador: void sumaPuntsA()
        Marcador: void sumaPuntsB()
        Marcador: int getPuntsA()
        Marcador: int getPuntsB()
        Marcador: String getTime()
        Marcador: setlblExtra(String lbl)
        Marcador: setCountDown(int milis)
        Marcador: incrementScore(int inr)
        Marcador: String getTime()
</div>
</center></p>
<p><a href="assets/Marcador.pde">Pots descarregar la nova versió ací</a></p>
<p>Per poder utilitzar la classe Marcador has de fer el mateix que has fet amb la classe Animation. Pots generar la documentació amb javadoc per tindre un manual d'ús més detallat.</p>
<details class="question">
<summary>Activitat 19. Afegeix la classe Animador al projecte</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="19:2"><input checked="checked" id="__tabbed_19_1" name="__tabbed_19" type="radio"/><input id="__tabbed_19_2" name="__tabbed_19" type="radio"/><div class="tabbed-labels"><label for="__tabbed_19_1">Problema</label><label for="__tabbed_19_2">Solució</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
<div class="tabbed-block">
<p>Encara no disponible</p>
</div>
</div>
</div>
</details>
<details class="question">
<summary>Activitat 20. Afegeix la classe Marcador al projecte</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="20:2"><input checked="checked" id="__tabbed_20_1" name="__tabbed_20" type="radio"/><input id="__tabbed_20_2" name="__tabbed_20" type="radio"/><div class="tabbed-labels"><label for="__tabbed_20_1">Problema</label><label for="__tabbed_20_2">Solució</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
<div class="tabbed-block">
<p>Encara no disponible</p>
</div>
</div>
</div>
</details>
<h2 id="herencia-i-polimorfisme">Herència i polimorfisme</h2>
<p>Apliquem ara les tècniques d'herència i polimorfisme vistes al tema 7. Farem que el nostre enemic puga ser de tres formes diferents: </p>
<ul>
<li>Un primer enemic tipus moneda que el nostre personatge haurà de perseguir i capturar</li>
<li>Un segon enemic que serà un robot que perseguirà al nostre personatge.</li>
<li>Un tercer enemic que serà de classe booster i accelerarà al nostre personatge.</li>
</ul>
<p><center>
<div class="mermaid">    classDiagram
    direction LR
    Trump: int grandaria
    Trump: float velocitat
    Trump: PVector posicio
    Trump: PVector direccio
    Trump: Animation animAmunt
    Trump: Animation animAvall
    Trump: Animation animDreta
    Trump: Animation animEsquerra
    Trump: Animation currentAnim

    Trump: Trump(PVector pos)
    Trump: Trump(Pvector pos, Pvector dir, float vel, int tam)
    Trump: void mostra()
    Trump: void actualitza()
    Trump: void rebota()
    Trump: void para()
    Trump: boolean colisionaAmb (Enemic e)
    Trump: boolean superaLimits (int alt, int ample)
    Trump: void giraDreta()
    Trump: void giraEsquerra()
    Trump: void giraDalt()
    Trump: void giraBaix()
    Trump: void carregaAnimacions()
    Trump: PVector getPosicio()
    Trump: void accelera()
    Trump: velocitatNormal()

    Enemic: PVector posicio
    Enemic: int grandaria
    Enemic: String tag
    Enemic: Animation anim
    Enemic: Enemic()
    Enemic: void mostra()
    Enemic: PVector getPosicio()
    Enemic: int getGrandaria()
    Enemic: String getTag()

    Enemic &lt;|-- Mexicano
    Enemic &lt;|-- Robot
    Enemic &lt;|-- Chilli

    Chilli: staminaExtra

    Robot: Animation animAmunt
    Robot: Animation animAvall
    Robot: Animation animDreta
    Robot: Animation animEsquerra
    Robot: Robot()
    Robot: update()

    Mexicano: int punts

    Main "1" --&gt; "1" Trump
    Main "1" --&gt; "10" Enemic
    Main "1" --&gt; "1" Marcador
    Main: int MAXMEX=10
    Main: int MAXCHI=3
    Main: int NUMROB=1
    Main: void setup()
    Main: void draw()
    Main: inicilialitzaApp()
    Main: gestionaAlarmes()
    Main: gestionaColisions()
    Main: mostraEnemics()
    Main: creaRobot()
    Main: mostraFinal()
    Main: keyPressed()
    Main: keyReleased()
    Main: mouseClicked()

</div>
</center></p>
<details class="question">
<summary>Activitat 21. Herència i polimorfisme</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="21:2"><input checked="checked" id="__tabbed_21_1" name="__tabbed_21" type="radio"/><input id="__tabbed_21_2" name="__tabbed_21" type="radio"/><div class="tabbed-labels"><label for="__tabbed_21_1">Problema</label><label for="__tabbed_21_2">Solució</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Modifica el que has fet fins ara al teu projecte boleta per tal d'afegir-li els diferents tipus d'enemics que hi hauran al joc. Programa tant el seu comportament i aparença diferencial a les classes derivades i no oblides de posar tot el codi comú a la superclasse. Per tal que tot funcione correctament has de fer un ús correcte de <strong>super()</strong>.</p>
</div>
<div class="tabbed-block">
<p>Encara no disponible</p>
</div>
</div>
</div>
</details>
<!--[ Descarrega la solució de l'activitat 18](assets/Activitat18.zip)-->
<h2 id="afegim-pantalles-al-projecte">Afegim Pantalles al Projecte</h2>
<p>A continuació el que farem serà afegir nivells que vagen augmentant la seua dificultat, però, com es fa? Encara que no es veja clar per ser un concepte un poc abstracte, una pantalla al nostre projecte serà una nova classe, per tant hem de plantejar la seua realització seguint el mètode que hem vist al tema 6 de programació orientada a objectes. </p>
<p>Però analitzem bé que és o què fa una <strong>pantalla</strong>. Una pantalla hauria de tindre control sobre el nombre d'enemics que apareixen i també els que queden per apareixer siguen de la subclasse que siguen, és a dir, si per exemple a la nostra pantalla han d'apareixer (màxim) 5 mexicans, 2 boosters i 1 robot, en tot moment es sabrà quants han aparegut i quants queden per apareixer.</p>
<p>La pantalla també podrà augmentar la dificultat conforme el nostre jugador va passant nivells simplement modificant el nombre màxim de cada classe d'enemic que poden apareixer. També hauria de tindre control sobre el temps (Marcador) fent que unes pantalles tinguen un temps il·limitat o un temps límit per acomplir els objectius. Tota pantalla o nivell tindrà uns objectius que quan s'acomplisquen s'haurà de passar de nivell.</p>
<p>Però primer analitzarem quines són les característiques i accions que podria realitzar un suposat objecte pantalla. Recorda que les característiques es convertiran eventualment en atributs de la classe i les possibles accions esdevindran mètodes. Tampoc oblides que una de les fortaleses del paradigma POO és la reutilització del codi per tal d'evitar la redundància, per tant és molt probable que hages de moure part del codi de les classes ja existents a la nova classe <strong>Pantalla</strong>. Bàsicament la majoria del codi que acabarà a la classe Pantalla es troba actualment al <strong>main</strong> del nostre projecte.</p>
<ul>
<li>Número (ordre)</li>
<li>Conjunt d'enemics</li>
<li>Total o màxim de cadascuna de les subclasses d'enemics</li>
<li>Temps màxim</li>
<li>Marcador del joc</li>
<li>Objectius del joc: nombre d'enemics, temps màxim...</li>
<li>Podem passar pantalles, saber quina és la pantalla següent</li>
<li>Hem de saber el resultat: guanyar o perdre el pantalla. Objectius acomplits.</li>
<li>Fons de la pantalla que distingisca una pantalla d'una altra.</li>
</ul>
<p>Un exemple de <strong>classe Pantalla</strong> podria ser el següent:</p>
<p><center>
<div class="mermaid">    classDiagram
    direction LR
    Pantalla: numero
    Pantalla: nom
    Pantalla: instruccions
    Pantalla: maxMexicans
    Pantalla: totalMexicansApareguts
    Pantalla: totalMexicansCapturats
    Pantalla: maxChilli
    Pantalla: totalChilliApareguts
    Pantalla: maxRobots
    Pantalla: totalRobotsApareguts
    Pantalla: passada
    Pantalla: imatgeFons
    Pantalla "1" --&gt; "1" Marcador
    Pantalla "1" --&gt; "N" Enemic
    Pantalla: Pantalla(int nivell)
    Pantalla: inicia ()
    Pantalla: paraMarcador ()
    Pantalla: bool objectiuAcomplit()
    Pantalla: addEnemic ()
</div>
</center></p>
<p>A banda de les diferents pantalles que formaran part del nostre joc, cada pantalla estarà dividida en tres sub fases:</p>
<ul>
<li><strong>Inici:</strong> Sub fase inicial en la que es mostrarien les instruccions (objectius) per tal de poder passar la pantalla.</li>
<li><strong>Joc:</strong> fase en la que s'està jugant i s'han d'aconseguir els objectius marcats per a la pantalla.</li>
<li><strong>Final:</strong> Mostra el resultat final</li>
</ul>
<p>Per tant al nostre programa principal podriem afegir un codi com el següent:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="k">switch</span><span class="w"> </span><span class="p">(</span><span class="n">subFase</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="n">INICI</span><span class="p">:</span>
<span class="w">            </span><span class="n">pantalla</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Pantalla</span><span class="w"> </span><span class="p">(</span><span class="n">numeroPantalla</span><span class="p">);</span>
<span class="w">            </span><span class="n">mostraPantallaInici</span><span class="p">();</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>

<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="n">JOC</span><span class="p">:</span>
<span class="w">            </span><span class="n">pantalla</span><span class="p">.</span><span class="na">mostraMarcador</span><span class="p">();</span>
<span class="w">            </span><span class="n">gestionaAlarmes</span><span class="p">();</span>
<span class="w">            </span><span class="n">trump</span><span class="p">.</span><span class="na">mostra</span><span class="p">();</span>
<span class="w">            </span><span class="n">trump</span><span class="p">.</span><span class="na">actaulitza</span><span class="p">();</span>
<span class="w">            </span><span class="n">gestionaColisions</span><span class="p">();</span>
<span class="w">            </span><span class="n">mostraEnemics</span><span class="p">();</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>

<span class="w">        </span><span class="k">case</span><span class="w"> </span><span class="n">FINAL</span><span class="p">:</span>
<span class="w">            </span><span class="n">mostraPantallaFinal</span><span class="p">();</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="admonition danger">
<p class="admonition-title">Com canviem d'una sub fase a una altra<p>El mateix switch que hem posat al nostre programa principal (draw) l'haurem de posara a la gestió dels esdeveniments, és a dir, mouseclicked i keyPressed, ja que si estem a la pantalla d'inici on es mostra la info i fem clic o premem una tecla del teclat, deurien deixar eixa primera sub fase per passar a la segona, la del joc.</p>
</p>
</div>
<h2 id="guardem-el-progres-del-joc">Guardem el progrés del joc</h2>
<p>Per guardar el progrés del joc hem de crear una classe amb extensió <strong>.java</strong> ja que si ho fem amb un fitxer <strong>.pde</strong> no es va a poder guardar en un fitxer com un objecte, ja que els fitxers <strong>.pde</strong> (Processing IDE) són PApplets i aquestos no són serializables. De la mateixa forma, a la nostra nova classe <strong>Partida</strong> que és la que guardarem en fitxers, no podrem posar com a membres de la classe cap altra classe creada amb Processing, és a dir, cap classe amb extensió <strong>.pde</strong></p>
<p>De moment no anem a complicar-ho massa i farem una classe que puga guardar: el número de pantalla a la que hem arribat, el total de punts acumulats i el temps que hem necessitat.</p>
<details class="question">
<summary>Activitat 22. Pantalles i guardar</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="22:2"><input checked="checked" id="__tabbed_22_1" name="__tabbed_22" type="radio"/><input id="__tabbed_22_2" name="__tabbed_22" type="radio"/><div class="tabbed-labels"><label for="__tabbed_22_1">Problema</label><label for="__tabbed_22_2">Solució</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Amplia el joc de forma que es puguen passar pantalles i que les guarde en un fitxer"</p>
</div>
<div class="tabbed-block">
<p>Encara no disponible</p>
</div>
</div>
</div>
</details>
<!--[Descarrega la solució de l'activitat 18](assets/Activitat19.zip)-->
<h3 id="controls-dinterficie-controlp5">Controls d'interfície ControlP5</h3>
<p>Fins ara el nostre joc s'iniciava a la pantalla que ens haviem quedat (si guardem de forma correcte l'objecte partida). Per tal de veure un poc més sobre interfícies utilitzant la llibreria ControlP5 que ens proporciona Processing IDE, farem una pantalla inicial com la següent:</p>
<div class="admonition danger">
<p class="admonition-title">Herència de PApplet<p>Per tal que els controls de ControlP5 funcionen, hauràs de fer que aquella classe que dibuixe la interfície (no deuria ser el main) siga una extensió de la classe PApplet</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">    </span><span class="kn">import</span><span class="w"> </span><span class="nn">controlP5.*</span><span class="p">;</span>

<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Menu</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">PApplet</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="n">ControlP5</span><span class="w"> </span><span class="n">cp5</span><span class="p">;</span>

<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="nf">Menu</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">cp5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ControlP5</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
</p>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": ".", "features": ["navigation.expand", "toc.integrate"], "search": "assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="assets/javascripts/bundle.b4d07000.min.js"></script>
<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
<script>mermaid.initialize({
    theme: "neutral"
});</script></body>
</html>